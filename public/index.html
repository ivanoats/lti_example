<html>
  <head>
    <meta charset="utf-8">
    <title>LTI Integrations</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      footer {
        border-top: 1px solid #e5e5e5;
        margin-top: 40px;
      }
      .app .icon {
        text-align: center;
      }
      .app h3 {
        text-align: center;
      }
      .app h3 a {
        color: #000;
      }
      .app {
        margin-bottom: 20px;
      }
      .app .header {
        padding: 5px;
      }
      .app:hover .header {
        background-color: #E5E5E5;
        border-radius: 3px;
        -moz-border-radius: 3px;
        -webkit-border-radius: 3px;
      }
      .app.single_app:hover .header {
        background: transparent;
      }
      .app .description {
        height: 130px;
        overflow: hidden;
      }
      .app.single_app .description {
        height: auto;
      }
      .app .extensions {
        margin-top: 5px;
      }
      .app .config {
        margin-top: 2px;
        visibility: hidden;
      }
      .app:hover .config {
        visibility: visible;
      }
      .data-row {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #E5E5E5;
      }
      .config_field {
        height: auto;
        width: 300px;
       }
       #preview {
        vertical-align: top;
       }
    </style>
    <link href="/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/bootstrap/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/bootstrap/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/bootstrap/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/bootstrap/ico/apple-touch-icon-57-precomposed.png">
  </head>
  <body>
    <div id="fb-root"></div>
    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">LTI of Magic</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li class="active"><a href="/index.html">Home</a></li>
              <li><a href="/talk.html">Talk</a></li>
              <li><a href="/tutorials.html">Tutorials</a></li>
              <li><a href="/code.html">Coding</a></li>
              <li><a href="/extensions.html">Extensions</a></li>
              <li><a href="https://github.com/whitmer/lti_example">Source</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
    <div class="container" id="content">
    <div class="hero-unit">
      <h1>LTI Integrations</h1>
      
      <p>
        Awesome stuff happens with <a href="http://www.imsglobal.org/lti/">LTI</a>. You know this is true. Here are some examples of LTI integrations you can use today.
      </p>
        Not familiar with LTI? Basically it's like Facebook apps or Google widgets for LMSs. The <a href="/tutorials.html">tutorials page</a> shows how to configure LTI tools in supported systems. There's also some handy extensions to LTI that you can learn more about on the <a href="/extensions.html">extensions page</a>. Tools with a gray label under their configuration xml support LTI extensions that won't work in all systems. Currently LTI extensions are only supported by Canvas.
      </p>
      <p style="float: right;">
        <a href="http://atutor.ca/"><img src='/lms/atutor.png' title="Works in ATutor 2.03+"/></a>
        <a href="http://www.blackboard.com"><img src='/lms/blackboard.png' title="Works in Blackboard Learn 9.1 SP4+"/></a>
        <a href="http://www.instructure.com"><img src='/lms/canvas.png' title="Works in Canvas by Instructure"/></a>
        <a href="http://www.desire2learn.com"><img src='/lms/desire2learn.png' title="Works in Desire2Learn 8.4+"/></a>
        <a href="http://www.jenzabar.com/products.aspx?id=148"><img src='/lms/eracer.png' title="Works in Jenzabar e-Racer 1.5+"/></a>
        <a href="http://moodle.org/"><img src='/lms/moodle.png' title="Works in Moodle 2.2+"/></a>
        <a href="http://sakaiproject.org/"><img src='/lms/sakai.png' title="Works in Sakai 2.7+"/></a>
        <a href="http://en.wikipedia.org/wiki/WebCT"><img src='/lms/webct.png' title="Works in WebCT 6+ (require PowerLink)"/></a>
      </p>
    </div>
    <div id="contents"></div>
    <footer class="footer">
      <p>Interested in writing your own LTI integrations? Check out the <a href="http://www.imsglobal.org/lti/">IMS page</a> for official specs, and the <a href="https://canvas.instructure.com/doc/api/tools_intro.html">Canvas API documentation</a> for some simple but powerful LTI extensions.</p>
    </footer>
  </div>
  <script src="jquery.min.js"></script>
  <script>
  if(location.href.match(/http:\/\/lti-examples\.heroku\.com/)) {
    location.href = location.href.replace(/^http/, 'https')
  }
  var tools = [];
  var extensions = {
    'editor_button': "rich editor",
    'course_nav': "course navigation"
  };
  $("#preview").live('click', function() {
    var tool = tools[0];
    $(".preview_pane").remove();
    var $div = $("<div/>", {'class': 'preview_pane well'});
    $div.append("<h2>Tool Preview:</h2>");
    $div.append($("<iframe/>", {
      src: tool.preview.url,
      frameborder: '0',
      style: "background: #fff; border: 1px solid #ccc; height: " + tool.preview.height + "px;"
    }).css('width', tool.preview.width ? (tool.preview.width + "px") : "100%"));
    $(".config").after($div);
  });
  $(".config_option").live('change keyup', function() {
    $(".config_field").each(function() {
      if(!$(this).attr('rel')) {
        $(this).attr('rel', $(this).val());
      }
      var url = $(this).attr('rel');
      var append = url.match(/\?/) ? "&" : "?";
      $(".config_option").each(function() {
        if($(this).attr('type') != 'checkbox' || $(this).attr('checked')) {
          append = append + encodeURIComponent($(this).attr('name')) + "=" + encodeURIComponent($(this).val()) + "&";
        }
      });
      append = append.substring(0, append.length - 1);
      $(this).val(url + append);
    });
  });
  $.getJSON('/data/lti_examples.json', function(data) {
    tools = data;
    var url = location.href;
    var args = (url.split(/\?/)[1] || "").split(/\&/);
    var params = {}
    for(var idx in args) {
      var arg = args[idx].split(/\=/);
      var key = arg[0];
      var value = arg[1];
      if(key && value) {
        params[key] = decodeURIComponent(value);
      }
    }
    var refUrl = "";
    if(params.tool) {
      var tool = null;
      for(var idx = 0; idx < tools.length; idx++) {
        if(tools[idx].id == params.tool) {
          tool = tools[idx];
        }
      }
      if(tool) {
        tools = [tool];
      }
    }
    
    var mod = 0;
    var $div = null;
    for(var idx = 0; idx < tools.length; idx++) {
      var tool = tools[idx];
      if(tool.full_tool) {
        tool.launch_url = "/tools.html?tool=" + tool.id;
        delete tool['data_url'];
      }
      if(tool.pending || tool.data_url) {
        continue;
      }
      var refUrl = location.protocol + "//" + location.host + "/index.html?tool=" + tool.id;
      if(mod == 0) {
        $div = $("<div/>", {'class': 'row'});
        $("#contents").append($div);
      }
      var $span = $("<span/>", {'class': 'span3 app'});
      var $spacer_span = $("<span/>", {'class': 'span2 app'});
      if(tools.length == 1) {
        $div.append($spacer_span);
        $span = $("<span/>", {'class': 'span8 app'});
      }
      $span.toggleClass('single_app', tools.length == 1);
      var html = "<div class='header'><div class='icon'><a href='/index.html?tool=" + tool.id + "'><img src='" + tool.image_url + "' alt=''/></a></div>";
      html = html + "<h3><a href='/index.html?tool=" + tool.id + "'>" + tool.name + "</a></h3>";
      if(tools.length == 1 || params['show_votes']) {
        html = html + "<div style='float: left; width: 55px; margin-right: 7px;'><a href='https://twitter.com/share' class='twitter-share-button' data-lang='en' data-count='vertical' data-url='" + refUrl + "' data-text='LTI Tool: " + tool.name + "'>Tweet</a></div>";
        html = html + "<div class='fb-like' data-send='false' data-layout='box_count' data-width='55' data-show-faces='false' data-href='" + refUrl + "' style='float: left; width: 55px;'></div>";
        html = html + "<div style='float: left; padding-top: 1px;'><div class='g-plusone' data-annotation='bubble' data-size='tall' data-width='55' data-href='" + refUrl + "'></div></div>";
        html = html + "<div style='clear: left;'></div>";
      }
      html = html + "<div class='description'>";
      if(tool['new']) {
        html = html + "<span class='label label-important'>NEW</span>&nbsp;";
      }
      html = html + tool.description + "</div></div>";
      if(tools.length == 1 || tool.extensions || tool.preview) {
        html = html + "<div class='config alert alert-info'>";
        if(tools.length == 1) {
          if(tool.config_url) {
            if(tool.config_options) {
              for(var jdx = 0; jdx < tool.config_options.length; jdx++) {
                var option = tool.config_options[jdx];
                if(option.type == "checkbox") {
                  html = html + "<div class='form-horizontal'><label><input style='margin: -4px 3px 0 0;' type='checkbox' class='config_option' name='" + option.name + "' value='" + option.value + "'/> " + option.description + "</label></div>";
                } else if(option.type == "text") {
                  html = html + "<div class='form-horizontal'><label>" + option.description + ": <input type='text' class='config_option' name='" + option.name + "' value='" + option.value + "'/></label></div>";
                }
              }
              html = html + "<br/>";
            }
            if(typeof(tool.config_url) == "string") {
              var url = tool.config_url;
              if(!url.match(/\/\//)) {
                url = location.protocol + "//" + location.host + url;
              }
              html = html + "<label>configuration url: <input type='text' title='copy this URL and paste it into the tool configuration in your LMS' class='config_field' value='" + url + "'/></label>";
            } else {
              for(var jdx = 0; jdx < tool.config_url.length; jdx++) {
                var url = tool.config_url[jdx].url;
                if(!url.match(/\/\//)) {
                  url = location.protocol + "//" + location.host + url;
                }
                html = html + "<label>" + tool.config_url[jdx].description + ": <input type='text' title='copy this URL and paste it into the tool configuration in your LMS' class='config_field' value='" + url + "'/></label>";
              }
            }
          } else if(tool.config_directions) {
            html = html + tool.config_directions;
          }
          if(tool.preview) {
            html = html + "<button id='preview' class='btn btn-primary'>Preview</button>"
          }
        }
        if(tool.extensions || tool.preview) {
          html = html + "<div class='extensions'>";
        }
        if(tool.preview && tools.length > 1) {
          html = html + "<span class='label label-info'>preview</span>&nbsp;";
        }
        if(tool.extensions) {
          for(var jdx = 0; jdx < tool.extensions.length; jdx++) {
            html = html + "<span class='label'>" + extensions[tool.extensions[jdx]] + "</span>&nbsp;";
          }
        }
        if(tool.extensions || tool.preview) {
          html = html + "</div>";
        }
        html = html + "</div>";
      }
      $span.html(html);
      $div.append($span);
      if(tools.length == 1) {
        $span.append("<div class='fb-comments' data-href='" + refUrl + "' data-num-posts='2'></div>");
        $div.append($spacer_span.clone());
        $(".app .config").css('visibility', 'visible');
        $("title,h1").text(tools[0].name);
      }
      mod = (mod + 1) % 4;
    }
    if(tools.length == 1 || params['show_votes']) {
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.src = 'https://apis.google.com/js/plusone.js';
      script.async = true;
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.src = '//platform.twitter.com/widgets.js';
      script.async = true;
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    }
    $(".config_option").change();
  });
  $(".config_field").live('click focus', function() {
    $(this).select();
  });
  </script>
  <script src="/analytics.js"></script>
  <script src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=197367153633354"></script>
  </body>
</html>
